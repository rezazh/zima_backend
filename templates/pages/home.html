{% extends "base/base.html" %}
{% load static %}

{% block title %}زیما | زیبایی خصوصی شما{% endblock %}
{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/pages/home.css' %}">
    <style>
        /* Sparkle Effect */
        .sparkle {
            position: fixed;
            width: 6px;
            height: 6px;
            background: var(--secondary-color);
            border-radius: 50%;
            pointer-events: none;
            z-index: 1000;
            animation: sparkleAnim 1s ease-out forwards;
        }

        @keyframes sparkleAnim {
            0% {
                opacity: 1;
                transform: scale(0);
            }
            50% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0);
            }
        }
    </style>
{% endblock %}
{% block content %}
<!-- Hero Section -->
<section class="hero">
    <div class="hero-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>

    <div class="hero-container">
        <div class="hero-content">
            <div class="hero-badge">
                <i class="fas fa-sparkles"></i>
                کالکشن جدید زمستان
            </div>
            <h1 class="hero-title">
                زیبایی <span class="highlight">خصوصی</span><br>
                شما را کشف کنید
            </h1>
            <p class="hero-description">
                مجموعه‌ای منحصربه‌فرد از لباس‌های زیر که احساس زیبایی و اعتماد به نفس را در شما بیدار می‌کند
            </p>
            <div class="hero-cta">
                <a href="{% url 'products:list' %}" class="btn btn-primary">
                    <span>کشف کالکشن</span>
                    <i class="fas fa-arrow-left"></i>
                </a>
                <a href="#" class="btn btn-secondary">
                    <i class="fas fa-play"></i>
                    <span>تماشای ویدیو</span>
                </a>
            </div>
        </div>

        <div class="hero-image">
            {# شما باید این تصویر را در static/images/zima_theme/ قرار دهید #}
            <img src="{% static 'images/zima.jpg' %}" alt="کالکشن زیما" class="hero-img">
            <div class="floating-elements">
                <div class="floating-element">
                    <i class="fas fa-star" style="color: var(--gold-accent); font-size: 1.5rem;"></i>
                </div>
                <div class="floating-element">
                    <i class="fas fa-heart" style="color: var(--coral); font-size: 1.2rem;"></i>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Collections Section -->
<section class="collections fade-in">
    <div class="section-header">
        <div class="section-badge">کالکشن‌های ویژه</div>
        <h2 class="section-title">
            سه دنیای <span class="script">زیبایی</span>
        </h2>
        <p class="section-description">
            هر کالکشن داستانی از زیبایی، راحتی و اعتماد به نفس را روایت می‌کند
        </p>
    </div>

    <div class="collections-grid">
        {# توجه: این بخش به بک‌اند متصل شده. شما باید دسته‌بندی‌هایی با این اسلاگ‌ها بسازید #}
        <div class="collection-card fade-in">
            <a href="{% url 'products:category_list' 'classic-chic' %}" class="text-decoration-none">
                <img src="{% static 'images/zima_theme/collection-classic.jpg' %}" alt="کلاسیک" class="collection-image">
                <div class="collection-content">
                    <h3 class="collection-title">کلاسیک و شیک</h3>
                    <p class="collection-description">مجموعه‌ای از طراحی‌های کلاسیک که هرگز از مد نمی‌افتد</p>
                    <div class="collection-link">
                        مشاهده کالکشن <i class="fas fa-arrow-left"></i>
                    </div>
                </div>
            </a>
        </div>

        <div class="collection-card fade-in">
            <a href="{% url 'products:category_list' 'romantic-beautiful' %}" class="text-decoration-none">
                <img src="{% static 'images/zima_theme/collection-romantic.jpg' %}" alt="رمانتیک" class="collection-image">
                <div class="collection-content">
                    <h3 class="collection-title">رمانتیک و زیبا</h3>
                    <p class="collection-description">طراحی‌های رمانتیک برای لحظات خاص زندگی شما</p>
                    <div class="collection-link">
                        مشاهده کالکشن <i class="fas fa-arrow-left"></i>
                    </div>
                </div>
            </a>
        </div>

        <div class="collection-card fade-in">
            <a href="{% url 'products:category_list' 'sporty-comfortable' %}" class="text-decoration-none">
                <img src="{% static 'images/zima_theme/collection-sporty.jpg' %}" alt="اسپرت" class="collection-image">
                <div class="collection-content">
                    <h3 class="collection-title">اسپرت و راحت</h3>
                    <p class="collection-description">راحتی و سبکی برای زندگی پر انرژی شما</p>
                    <div class="collection-link">
                        مشاهده کالکشن <i class="fas fa-arrow-left"></i>
                    </div>
                </div>
            </a>
        </div>
    </div>
</section>

<!-- Featured Products -->
<section class="featured fade-in">
    <div class="products-container">
        <div class="section-header">
            <div class="section-badge">محبوب‌ترین‌ها</div>
            <h2 class="section-title">
                پرفروش‌ترین <span class="script">محصولات</span>
            </h2>
            <p class="section-description">
                محصولاتی که بیشترین رضایت را از مشتریان عزیز دریافت کرده‌اند
            </p>
        </div>
        <div class="products-grid">
            {% for product in featured_products|slice:":8" %} {# نمایش تا 8 محصول ویژه #}
            <div class="product-card fade-in">
                <div class="product-image-container">
                    <div class="product-badge">
                        {% if product.is_new %}
                        <span class="product-badge new">جدید</span>
                        {% endif %}
                        {% if product.has_discount %}
                        <span class="product-badge sale">{{ product.discount_percent }}% تخفیف</span>
                        {% endif %}
                        {% if product.is_featured %}
                        <span class="product-badge">ویژه</span>
                        {% endif %}                    </div>
                    <div class="product-favorite" onclick="toggleWishlist(this, '{{ product.id }}')">
                        <i class="far fa-heart"></i>
                    </div>
                    {% with image=product.get_main_image %}
                    <img src="{% if image %}{{ image.image.url }}{% else %}{% static 'images/zima_theme/product-placeholder.jpg' %}{% endif %}" alt="{{ product.name }}" class="product-image">
                    {% endwith %}
                </div>
                <div class="product-info">
                    <div class="product-brand">{{ product.brand }}</div>
                    <h3 class="product-name">{{ product.name }}</h3>
                    <div class="product-rating">
                        <div class="stars">
                            {% with rating=product.get_average_rating %}
                            {% for i in "12345" %}
                            <i class="fa{% if forloop.counter <= rating %}s{% else %}r{% endif %} fa-star star"></i>
                            {% endfor %}
                            {% endwith %}
                        </div>
                        <span class="rating-text">({{ product.get_rating_count }} نظر)</span>
                    </div>
                    <div class="product-price">
                        {% if product.has_discount %}
                        <span style="text-decoration: line-through; color: var(--warm-gray); font-size: 1rem; margin-left: 10px;">{{ product.price|floatformat:0 }}</span>                        {{ product.get_discount_price|floatformat:0 }} تومان
                        {% else %}
                        {{ product.price|floatformat:0 }} تومان
                        {% endif %}
                    </div>
                    <div class="product-actions">
                        <button class="btn-add-cart" onclick="addToCartHome('{{ product.id }}')">افزودن به سبد</button>
                        <a href="{{ product.get_absolute_url }}" class="btn-quick-view">
                            <i class="fas fa-eye"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="empty-state">
                <i class="fas fa-box-open"></i>
                <h3>محصول ویژه‌ای برای نمایش وجود ندارد.</h3>
                <p>به زودی محصولات جدیدی اضافه خواهد شد.</p>            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Testimonials -->
<section class="testimonials fade-in">
    <div class="testimonials-container">
        <div class="section-header">
            <div class="section-badge">نظرات مشتریان</div>
            <h2 class="section-title">
                آنچه <span class="script">مشتریان</span> می‌گویند
            </h2>
        </div>
        <div class="testimonials-slider">
            <div class="testimonial-card">
                <p class="testimonial-text">کیفیت محصولات زیما واقعاً فوق‌العاده است. راحتی و زیبایی در کنار هم. من عاشق این برند شدم!</p>
                <div class="testimonial-author">
                    <div class="author-avatar">س</div>
                    <div class="author-info">
                        <h4>سارا احمدی</h4>
                        <p>مشتری وفادار</p>
                    </div>
                </div>
            </div>
            <div class="testimonial-card">
                <p class="testimonial-text">خرید من از زیما تجربه‌ای بی‌نظیر بود. از کیفیت تا خدمات پس از فروش، همه چیز عالی!</p>
                <div class="testimonial-author">
                    <div class="author-avatar">م</div>
                    <div class="author-info">
                        <h4>مریم نوری</h4>
                        <p>مشتری جدید</p>
                    </div>
                </div>
            </div>
            <div class="testimonial-card">
                <p class="testimonial-text">پس از سال‌ها جستجو، بالاخره برندی پیدا کردم که هم راحت باشد هم زیبا. ممنون زیما!</p>
                <div class="testimonial-author">
                    <div class="author-avatar">ن</div>
                    <div class="author-info">
                        <h4>نیلوفر رضایی</h4>
                        <p>مشتری راضی</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    // تابع افزودن به سبد خرید برای صفحه اصلی (فقط نمایش Toast)
    function addToCartHome(productId) {
        showLoading();
        // در اینجا می‌توانید یک درخواست AJAX واقعی برای افزودن به سبد خرید ارسال کنید.
        // برای سادگی فعلا فقط یک Toast نمایش داده می‌شود.
        setTimeout(() => {
            hideLoading();
            showToast('محصول به سبد خرید اضافه شد', 'check');
            // در اینجا می‌توانید تعداد آیتم‌های سبد خرید در هدر را به‌روز کنید
            // مثلاً: updateCartBadge();
        }, 1000);
    }

    // Testimonials Auto Scroll
    const testimonialSlider = document.querySelector('.testimonials-slider');
    if (testimonialSlider) {
        let testimonialScrollAmount = 0;
        setInterval(() => {
            // عرض هر کارت + فاصله بین آن‌ها (350px + 40px)
            testimonialScrollAmount += 390;
            if (testimonialScrollAmount >= testimonialSlider.scrollWidth - testimonialSlider.clientWidth) {
                testimonialScrollAmount = 0; // بازگشت به ابتدا
            }
            testimonialSlider.scrollTo({
                left: testimonialScrollAmount,
                behavior: 'smooth'
            });
        }, 4000);
    }
</script>
{% endblock %}